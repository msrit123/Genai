 # 9a
from transformers import pipeline
gen = pipeline("text-generation", model="gpt2")

print(gen("Write a short promotional text for a new smart fitness watch.",
          max_length=60,do_sample=True,no_repeat_ngram_size=3)[0]["generated_text"])


#9b
!pip install transformers pillow -q
from transformers import BlipProcessor, BlipForConditionalGeneration
from google.colab import files
from PIL import Image

u = files.upload()
img = Image.open(list(u.keys())[0]).convert("RGB")

p = BlipProcessor.from_pretrained("Salesforce/blip-image-captioning-base")
m = BlipForConditionalGeneration.from_pretrained("Salesforce/blip-image-captioning-base")

out = m.generate(**p(img, return_tensors="pt"))
print(p.decode(out[0], skip_special_tokens=True))


# 9c
from transformers import AutoTokenizer, AutoModelForSeq2SeqLM

tokenizer = AutoTokenizer.from_pretrained("facebook/bart-large-cnn")
model = AutoModelForSeq2SeqLM.from_pretrained("facebook/bart-large-cnn")

input_text = """ Machine learning is a subset of artificial intelligence that focuses on the
development of algorithms that can learn and make predictions from data.
It enables systems to automatically improve their performance without being
explicitly programmed. Machine learning techniques are widely used in various
applications such as email filtering, speech recognition, medical diagnosis,
and self-driving cars. By analyzing large amounts of data, these algorithms
can identify hidden patterns, make accurate predictions, and support
decision-making processes across industries. As data continues to grow,
machine learning plays an increasingly vital role in advancing automation
and intelligent systems."""

inputs = tokenizer([input_text], max_length=1024, return_tensors="pt", truncation=True)

# Generate Summary
summary_ids = model.generate(
    inputs["input_ids"],
    num_beams=4,
    min_length=10,
    max_length=20,
    early_stopping=True
)

summary_text = tokenizer.decode(summary_ids[0], skip_special_tokens=True)
print(summary_text)
